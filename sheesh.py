import pandas as pd
import requests

date_ideas = [
    {"title": "Вечер рисования", "description": "Организуйте арт-вечер с красками и холстами, даже если вы не умеете рисовать."},
    {"title": "Weekend в загородном отеле", "description": "Сбегите на выходные из города, устроив мини-отпуск в отеле или глэмпинге."},
    {"title": "Стендап", "description": "Сходите вместе на вечер стендапа, чтобы вдоволь посмеяться и зарядиться настроением."},
    {"title": "Поход в спа", "description": "Расслабьтесь на парном массаже и других процедурах для двоих."},
    {"title": "Конная прогулка", "description": "Прокатитесь на лошадях вместе по живописным местам."},
    {"title": "Парк аттракционов", "description": "Проведите день, катаясь на аттракционах и вспоминая детство."},
    {"title": "Киновечер под открытым небом", "description": "Возьмите плед и отправляйтесь на вечерний киносеанс под звездами."},
    {"title": "Посещение винного мероприятия", "description": "Дегустируйте вина и выберите бутылочку для уютного вечера дома."},
    {"title": "Гончарный мастер-класс", "description": "Создайте что-то своими руками вместе на гончарном мастер-классе."},
    {"title": "Свидание с квестом", "description": "Организуйте день-сюрприз, где второй половинке нужно искать активности по запискам."},
    {"title": "Блошиный рынок", "description": "Поищите вместе винтажные находки на барахолке и поделитесь открытиями."},
    {"title": "Катание на велосипедах", "description": "Прокатитесь вдвоем по красивому маршруту и устройте пикник в пути."},
    {"title": "Йога в парке", "description": "Попробуйте парную йогу на свежем воздухе в спокойной атмосфере."},
    {"title": "Игровой вечер с видеоиграми", "description": "Сразитесь друг с другом в любимые видеоигры и повеселитесь."},
    {"title": "Сборка конструктора LEGO", "description": "Соберите вместе сложную модель LEGO — это объединяет и расслабляет."},
    {"title": "Поход в театр", "description": "Насладитесь живым искусством и обсудите спектакль за ужином."},
    {"title": "Посадка растения", "description": "Выберите горшок и растение, посадите его как символ ваших отношений."},
    {"title": "Мастер-класс по букетам", "description": "Создайте красивый букет своими руками и заберите его домой."},
    {"title": "Посещение оленьей фермы", "description": "Покормите милых оленей и устройте фотосессию в сказочной атмосфере."},
    {"title": "Игровые автоматы", "description": "Проведите вечер в зале с аркадами, соревнуясь за лучшие очки."},
    {"title": "Шоппинг", "description": "Прогуляйтесь по магазинам, примеряйте забавные образы и выбирайте друг другу подарки."},
    {"title": "Road trip", "description": "Садитесь в машину и поезжайте в новое место — без чёткого плана, только приключения."},
    {"title": "Марафон мультфильмов", "description": "Включите подборку любимых мультфильмов и расслабьтесь с пижамами и пиццей."},
    {"title": "Настольные игры", "description": "Выберите настолку на двоих и устройте вечер весёлой конкуренции."},
    {"title": "День в аквапарке", "description": "Катайтесь на горках, наслаждайтесь волнами и смейтесь вместе до слёз."},
    {"title": "Парный массаж", "description": "Расслабьтесь на совместной спа-процедуре, чтобы зарядиться новыми силами."},
    {"title": "Поход за город", "description": "Возьмите термос, плед и отправляйтесь в мини-поход по живописным местам."},
    {"title": "Приготовление необычного блюда", "description": "Выберите рецепт, который никогда не готовили, и создайте кулинарный шедевр вдвоём."},
    {"title": "Домашнее спа", "description": "Устройте вечер уюта: ванна с пеной, маски, свечи и массаж."},
    {"title": "Зарядка на улице", "description": "Начните день со свежего воздуха и бодрящей зарядки вместе."},
    {"title": "Вечер коктейлей", "description": "Миксуйте домашние коктейли, экспериментируйте и пробуйте новинки."},
    {"title": "Фотосессия на закате", "description": "Найдите красивую локацию и сделайте памятные фотографии на фоне заката."},
    {"title": "Скрапбукинг", "description": "Создайте альбом воспоминаний из фото, записок и милых мелочей."},{"title": "Художественная галерея", "description": "Прогуляйтесь по выставке и найдите вдохновение в искусстве."},
    {"title": "Боулинг", "description": "Устройте весёлое соревнование на дорожках с призом для победителя."},
    {"title": "Пикник", "description": "Соберите корзину с едой и устройте пикник в парке или на природе."},
    {"title": "Капсула времени", "description": "Напишите друг другу письма в будущее, запечатайте и спрячьте."},
    {"title": "Совместный спортзал", "description": "Потренируйтесь вместе, поддерживая и мотивируя друг друга."},
    {"title": "Чайная церемония", "description": "Проведите вечер за завариванием и дегустацией разных сортов чая."},
    {"title": "Киновечер с проектором", "description": "Проецируйте фильм на стену и создайте атмосферу домашнего кинотеатра."},
    {"title": "Видео в соцсети", "description": "Снимите трендовое или смешное видео вместе и поделитесь с друзьями."},
    {"title": "Доска воспоминаний", "description": "Украсьте доску совместными фото, билетами и любимыми цитатами."},
    {"title": "Сап-серфинг", "description": "Арендуйте SUP-доски и исследуйте водоёмы вместе."},
    {"title": "Шоппинг для дома", "description": "Проведите день, выбирая уютные вещи и декор для вашего пространства."},
    {"title": "Цветочная композиция", "description": "Соберите цветочную инсталляцию из живых растений и украсьте ею дом."},
    {"title": "Завтрак в постель", "description": "Проснитесь пораньше и приготовьте вкусный завтрак с сюрпризом."},
    {"title": "Приготовление торта", "description": "Испеките торт вместе — повеселитесь и угоститесь результатом."},
    {"title": "Органный концерт", "description": "Посетите вечер классической музыки в исполнении органа — незабываемые эмоции гарантированы."}
]


# Функция отправки на API
def send_ideas_to_api(df: pd.DataFrame, api_url: str):
    headers = {'Content-Type': 'application/json'}
    success_count, fail_count = 0, 0

    for idx, row in df.iterrows():
        payload = {
            "title": row["title"],
            "description": row["description"]
        }

        response = requests.post(api_url, json=payload, headers=headers)
        if response.status_code == 201:
            success_count += 1
        else:
            fail_count += 1
            print(f"❌ Failed at row {idx}: {response.status_code} — {response.text}")

    print(f"\n✅ Sent {success_count} ideas successfully.")
    if fail_count:
        print(f"⚠️ Failed to send {fail_count} ideas.")

# Преобразуем в DataFrame
df_ideas = pd.DataFrame(date_ideas)

# Параметры
api_url = "https://api-date-ideas.vyachik-dev.ru/date-ideas"

# Вызывать эту функцию можно после проверки и готовности API
send_ideas_to_api(df_ideas, api_url)